---
title: Using the C# Script Component
aliases:
  - introduce the C# Script component, discuss inputs, outputs, types, etc, and show the basics of how to write simple code inside.
---
### S

1. C# 스크립트 컴포넌트의 기본 구조
- 일반적인 Grasshopper 컴포넌트처럼 좌측 입력, 우측 출력 구조
- 특별한 'out' 출력이 있어 콘솔처럼 정보를 출력
- 입력과 출력의 이름을 사용자가 커스터마이징 가능

2. 코드 작성 환경
- 컴포넌트 더블클릭으로 스크립트 에디터 실행
- Grasshopper_Script에서 상속받은 클래스 형태
- System, Rhino, Grasshopper 라이브러리 사용 가능
- RunScript 메서드가 핵심 실행 함수

3. 입출력 처리 방법
- 출력은 참조 인자로 처리됨
- 기본적으로 모든 입출력은 generic object 타입
- 입력 타입은 우클릭으로 double, string 등으로 변경 가능
- 접근 타입을 Item, List, DataTree로 설정 가능

4. 실제 사용 예시
```csharp
// 문자열 출력
A = "Hello World";

// 수학 연산
sum = x + y;
squareRoot = Math.Sqrt(x);

// 콘솔 출력
Print("First input value was " + x);
```

5. 주요 기능
- 실시간 에러 메시지 표시
- IntelliSense를 통한 코드 자동 완성
- 컴포넌트 이름과 색상 커스터마이징 가능
- 콘솔 출력을 위한 Print 함수 제공

6. 사용 시 주의사항
- 입출력 추가 후에는 스크립트 에디터를 재실행해야 반영
- Print 함수는 문자열만 직접 받을 수 있음
- 회색 영역의 코드는 수정 불가
- 타입 변환 시 explicit 변환 필요

7. 향후 학습 방향
- 기본 연산에서 시작하여 점진적으로 기하학적 작업으로 확장
- 실제 플러그인 개발을 위한 기초 작업
- 다양한 예제를 통한 실습 진행 예정


### C

이번 영상에서는 C# 스크립트 컴포넌트를 소개하고 작동 방식을 자세히 살펴보고자 합니다. 입력을 어떻게 커스터마이징하고, 출력을 어떻게 커스터마이징하며, 내부에 코드를 어떻게 작성하는지, 그리고 우리의 첫 Grasshopper 스크립트 컴포넌트를 작성하는 방법에 대해 알아보겠습니다.

먼저 상기시켜드리면, 'Grasshopper 고급 개발' 시리즈에서는 여러분이 이미 C# 프로그래밍 언어에 익숙하다고 가정합니다. 만약 그렇지 않다면, 설명에 링크가 있고 화면 어딘가에 카드로 뜨고 있을 'Learning C#' 플레이리스트와 같은 학습 자료를 참고하시기 바랍니다. 언어에 대한 이해를 전제로, 이 언어를 사용해 스크립팅 컴포넌트에서 어떻게 개발하는지에 초점을 맞추겠습니다.

먼저 컴포넌트를 자세히 살펴보겠습니다. 다른 Grasshopper 컴포넌트와 마찬가지로 왼쪽에 입력, 오른쪽에 출력이 있습니다. 그리고 잠시 후 설명드릴 특별한 'out' 출력이 있습니다. 특별한 점은 축소했을 때는 입력과 출력만 보이지만, 확대하면 더 많은 입출력을 추가할 수 있다는 것입니다. 우클릭으로 이름도 변경할 수 있습니다. 예를 들어 입력을 'my input'으로, 출력을 'amazing output'이나 'super cool geometry'로 바꿀 수 있습니다.

그럼 이 컴포넌트로 어떻게 스크립팅을 할까요? 컴포넌트를 더블클릭하면 코드를 작성할 수 있는 스크립트 에디터가 나타납니다. C#에 익숙하시다면 여기서 보이는 것들이 많이 친숙할 것입니다. 모든 영역을 펼쳐보면, 먼저 Grasshopper_Script를 상속받는 클래스가 있고, System 라이브러리, Rhino 라이브러리, Grasshopper 라이브러리를 사용하는 것을 볼 수 있습니다. 스크립트 인스턴스에는 출력 메서드, RhinoCommon 작업 등에 대한 접근권한이 있습니다. 이런 것들은 다음 영상에서 설명하겠습니다.

지금은 'RunScript' 메서드에 집중해보겠습니다. 이는 모든 C# 스크립트 컴포넌트에 있는 주요 함수로, Grasshopper 컴포넌트가 업데이트될 때마다 실행될 코드를 포함합니다. 슬라이더를 조정하거나 데이터가 변경될 때 연결된 모든 컴포넌트가 업데이트되고 변경되는 것을 아시죠? 여기 작성하는 코드가 그러한 업데이트마다 실행됩니다.

C#에 익숙하시다면 이것이 메서드, 함수라는 것을 아실 텐데요, Grasshopper 커널이나 엔진이 모든 컴포넌트를 확인하고 RunScript 메서드를 실행하는 것을 처리합니다. 우리는 그걸 신경 쓸 필요가 없습니다. 하지만 각 메서드에 있는 인자들은 신경 써야 합니다. x, y, z, 'my input' 같은 입력 인자들이 있고, 이것들은 제가 여기서 커스터마이징한 것들입니다. 출력은 좀 혼란스러울 수 있는데, 여러 개이기 때문에 이 메서드에서는 참조 출력으로 처리됩니다. 출력이 함수의 인자로 전달되고, 우리는 이 인자들을 참조로 사용해 정보를 출력합니다.

간단한 예제를 보겠습니다. 이 복잡해진 컴포넌트를 지우고 새것을 추가하겠습니다. A 출력에 패널 하나를 연결하고, out 출력에도 패널을 연결하겠습니다. 아직 입출력을 수정하지 않았으니, 더블클릭하면 RunScript 컴포넌트가 매우 단순한 것을 볼 수 있습니다. 입력 x, y와 출력 A만 있네요. 참고로 Control을 누르고 마우스 휠을 사용해서 확대하고 있습니다.

이제 코드를 작성해볼 수 있습니다. 앞서 말씀드렸듯이 출력은 참조 인자로 처리되므로, 이 컴포넌트에서 뭔가를 출력하려면 단순히 객체 A에 값을 할당하면 됩니다. 기본적으로 출력은 항상 제네릭 object이기 때문에, 문자열이든 리스트든 정수든 뭐든 상관없습니다. 예를 들어 출력으로 'hello world' 문자열을 내보내고 싶다면, A = "hello world";라고 하고 세미콜론을 붙이면 됩니다.

왼쪽에 도킹하고 RunScript 버튼을 누르면, 이 코드가 컴파일되고 한 번 실행됩니다. 그러면 A 출력에서 Hello World가 나오는 것을 볼 수 있습니다. 멋지죠?

다른 것도 해보겠습니다. B라는 두 번째 출력을 추가하고, 1 + 3의 결과를 출력해보겠습니다. 하지만 입출력을 추가할 때는 바로 함수에 반영되지 않으니 창을 닫았다가 다시 열어야 합니다. 패널을 복사해서 B에 연결하면 숫자 4가 나옵니다. 좋습니다.

C라는 출력을 더 추가해서 Math.의 자동완성 추천을 보면서 25의 제곱근을 구해보겠습니다. 결과가 5가 나오길 바라는데... 맞네요!

이처럼 컴포넌트에서 데이터를 출력하는 것은 A, B, C 등의 이름을 가진 출력에 값을 할당하는 것만큼 간단합니다. 이는 보통 모든 데이터 처리가 끝난 후 컴포넌트 마지막에 이루어집니다.

네, 나머지 부분을 이어서 번역하겠습니다:

"물론 우리가 실제로 하고 싶은 것은 출력이 입력 데이터와 관련되게 하는 것입니다. 지금은 'Hello world', 4, 5가 하드코딩되어 있어서 어떤 것을 연결하든 항상 같은 출력이 나옵니다. 여기에 몇 개의 숫자를 입력하고, 그 값을 읽어서 예를 들어 덧셈을 하고 싶습니다. 좀 더 구체적으로 하기 위해 이것을 'sum'(합계)이라 부르고, 이것을 'square root'(제곱근)이라고 하겠습니다.

바로 오류가 발생하는 것을 볼 수 있습니다. 이 오류는 출력 이름을 변경했기 때문입니다. B와 C가 더 이상 존재하지 않고 'sum'과 'square root'로 바뀌었죠. 코드를 실행하면 모든 것이 정상으로 돌아옵니다.

이제 이 두 값을 읽어서 연산하고 싶습니다. 이것은 이 둘의 합이 되어야 하고, 이것은 그 중 하나의 제곱근이 되어야 합니다. x와 y를 입력으로 가지고 있으니 x + y를 할 수 있을 것 같죠? 하지만 작동하지 않습니다.

왜 작동하지 않는지 먼저 살펴봅시다. 어떤 오류가 발생하는지 어떻게 알 수 있을까요? 먼저 컴포넌트가 바로 빨간색으로 변하는 것을 볼 수 있습니다. 버블을 클릭하면 'operator + cannot be applied to two objects of type object'라는 오류 메시지가 나옵니다. 이는 object 타입 두 개에 더하기 연산자를 적용할 수 없다는 뜻입니다. 

이 같은 오류 메시지는 컴포넌트의 특별한 'out' 출력을 통해서도 볼 수 있습니다. 이 out 출력은 스크립팅 컴포넌트의 매우 특별한 출력으로, 콘솔이라고 생각하시면 됩니다. 정보를 출력하고 writeline 등을 할 수 있는 콘솔입니다. 오류 메시지, 경고 메시지를 볼 수 있고 우리가 직접 메시지를 출력할 수도 있어서 매우 유용합니다. 그래서 오류를 읽거나 중간 데이터를 출력하기 위해 항상 out에 패널을 연결해두는 것이 매우 도움이 됩니다.

이제 문제가 무엇인지 살펴봅시다. object 타입과 object 타입을 더할 수 없다는데, 이게 무슨 뜻일까요? Grasshopper 스크립트를 보면 이 함수의 입력이 x와 y입니다. 이는 좋지만, 이 데이터의 타입이 object와 object입니다. 이는 C# 스크립트 컴포넌트에 새 입력을 만들 때 기본적으로 그 입력의 타입이 제네릭 object라는 뜻입니다. 제네릭 object는 C# 내의 다른 모든 타입이 상속받는 가장 기본적인 객체입니다.

이것의 장점은 유연성을 제공한다는 것입니다. 단점은 C#이 이것들이 정수인지, double인지, 문자열인지 등을 알 수 없다는 것입니다. 그래서 우리는 이 두 컴포넌트의 입력이 double 숫자여야 한다고 지정해줄 필요가 있습니다.

어떻게 할 수 있을까요? 입력을 우클릭하면 몇 가지를 커스터마이징할 수 있습니다. 입력의 타입을 현재의 제네릭 object 대신 Boolean, integer, double, string, datetime, guid 등으로 지정할 수 있고, point, vector, box, transform, line, curve 등의 기하학적 타입도 있습니다. 이는 곧 보게 될 것입니다만, 앞으로 2-3개 영상에서는 기본적인 C# 타입만 다룰 것입니다.

이 입력을 숫자 타입으로 하고 싶으니 여기서 double을 선택하고, y도 마찬가지로 double로 선택합니다. 보세요, 컴포넌트가 바로 작동하기 시작했습니다. 더블클릭해보면 스크립팅 컴포넌트가 object 타입을 double로 바꾼 것을 볼 수 있습니다.

'Jose, 여기에 직접 타입을 입력하면 되지 않나요?'라고 생각하실 수 있는데, C# 스크립트 컴포넌트의 회색 영역은 수정할 수 없습니다. 하얀색 영역만 수정할 수 있습니다. 그래서 이러한 수정은 메뉴에서 옵션을 선택해서 해야 합니다.

앞으로 매우 중요해질 또 다른 옵션은 'access type'(접근 타입)입니다. 이는 입력이 단일 항목만 받을지(앞으로 몇 개의 영상에서는 이렇게 할 것입니다), 리스트를 받을지, 아니면 데이터 트리를 받을지 선택할 수 있습니다. 더블클릭해보면 이제 double 요소들의 데이터 트리가 있는 것을 볼 수 있습니다. 데이터 트리는 C#의 기본 기능이 아니라 Grasshopper가 제공하는 것입니다. 데이터 트리 구조가 무엇이고 어떻게 작동하며 왜 흥미로운지 자세히 설명하겠습니다. 지금은 개별 요소를 하나씩 다루기 위해 항상 'item' 접근 타입으로 작업할 것입니다.

이제 둘 다 double로 설정했으니 더블클릭해보면 이들이 double로 처리되는 것을 볼 수 있고, x의 제곱근을 구하는 것도 문제없습니다. 제곱근이 π에 매우 가깝네요, 우연의 일치군요! 재미있습니다.

더 추가할 수도 있습니다. 예를 들어 'multiplication'(곱셈)을 추가하고 x * y를 하면, 패널을 연결했을 때 100이라는 결과가 나옵니다. 꽤 쉽죠?

이제 out 출력에 커스텀 정보를 어떻게 출력하는지 보여드리고 싶습니다. C# 스크립트 컴포넌트 내에서 대문자 'Print' 특수 함수에 접근할 수 있습니다. Print는 텍스트 객체나 인자가 있는 객체를 받을 수 있습니다. 예를 들어 'Hello message to the console'이라고 출력하면 여기에 나타납니다.

한 가지 주의사항은 Print 함수는 문자열만 받을 수 있고 integer, double 등의 오버로드가 없다는 것입니다. 예를 들어 x의 값을 출력하려고 하면 오류가 발생합니다. 59번 줄의 인자를 double 타입에서 string 타입으로 변환할 수 없다고 합니다.

이는 좀 귀찮지만, 해결방법이 있습니다. 숫자를 출력할 때는 ToString 메서드를 사용해서 문자열로 변환하거나, 다른 문자열과 결합해서 자동 변환이 일어나게 할 수 있습니다. 예를 들어 'First input value was'라는 문자열과 x를 결합하면 x가 자동으로 문자열로 변환됩니다. 그러면 'First input value was 10'이라고 출력됩니다.

C# 스크립트 컴포넌트는 다른 Grasshopper 컴포넌트처럼 이름을 바꿀 수 있습니다. 예를 들어 이 컴포넌트의 이름을 'my bad component'라고 하고 페인트 버킷으로 C# 아이콘을 덮을 수 있습니다. 제가 아이콘을 매우 좋아한다는 걸 아시겠지만, C# 스크립트 컴포넌트의 경우는 예외입니다. 이름을 사용하지 않으면 어떻게 다르게 작동하는지 알 수 없기 때문에, C# 스크립트 컴포넌트에는 텍스트를 사용하는 것을 더 선호합니다. 개인적인 선호도입니다.

이것으로 C# 스크립팅 소개와 Grasshopper 내에서의 간단한 산술 연산 사용법에 대한 설명을 마치겠습니다. 아직 지오메트리는 다루지 않았는데, 이는 2-3개의 영상 후에 다룰 것입니다.

다음으로는 몇 가지 예제를 살펴보고 이 시리즈를 통해 점진적으로 만들어갈 플러그인의 프로토타입을 시작해보겠습니다. 